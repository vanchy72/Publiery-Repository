<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Iniciar Sesión | TuPlataforma</title>
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600;700&display=swap" rel="stylesheet" />
  <link rel="stylesheet" href="css/styles.css" />
  <link rel="stylesheet" href="css/login.css" />
  
</head>
<body>
  <div class="login-wrapper">
    <div class="login-card">
      <div class="logo-header">
        <h1>TuPlataforma</h1>
      </div>
      <h2>Iniciar Sesión</h2>
      <form id="loginForm">
        <label for="correo">Correo electrónico</label>
        <input type="email" id="correo" name="correo" required />

        <label for="password">Contraseña</label>
        <input type="password" id="password" name="password" required />

        <button type="submit" class="btn-login">Entrar</button>
      </form>
      <div style="margin-top:1rem;text-align:center;">
        <a href="#" id="enlaceRecuperar" style="color:#4f46e5;text-decoration:underline;cursor:pointer;">¿Olvidaste tu contraseña?</a>
      </div>
      <div id="recuperarFormContainer" style="display:none;margin-top:2rem;text-align:center;">
        <h3>Recuperar contraseña</h3>
        <form id="recuperarForm" style="max-width:320px;margin:auto;">
          <input type="email" id="recuperarEmail" placeholder="Tu email" required style="width:100%;padding:0.7rem;margin-bottom:1rem;border-radius:6px;border:1px solid #ccc;">
          <button type="submit" class="btn" style="background:#10b981;color:#fff;font-weight:600;width:100%;">Enviar enlace</button>
        </form>
        <div id="recuperarMensaje" style="margin-top:1rem;"></div>
        <button id="cerrarRecuperar" style="margin-top:1rem;background:none;border:none;color:#e74c3c;cursor:pointer;">Cancelar</button>
      </div>
      <p class="registro-link">¿No tienes cuenta? <a href="registro.html">Regístrate aquí</a></p>
    </div>
  </div>
  <script src="js/login.js?v=2025"></script>
  <script>
    // Recuperar contraseña
    document.getElementById('enlaceRecuperar').addEventListener('click', function(e) {
      e.preventDefault();
      document.getElementById('recuperarFormContainer').style.display = 'block';
    });
    document.getElementById('cerrarRecuperar').addEventListener('click', function() {
      document.getElementById('recuperarFormContainer').style.display = 'none';
    });
    document.getElementById('recuperarForm').onsubmit = async function(e) {
      e.preventDefault();
      const email = document.getElementById('recuperarEmail').value.trim();
      const mensaje = document.getElementById('recuperarMensaje');
      mensaje.textContent = 'Enviando...';
      try {
        const res = await fetch('api/usuarios/solicitar_recuperacion.php', {
          method: 'POST',
          headers: { 'Content-Type': 'application/json' },
          body: JSON.stringify({ email })
        });
        const data = await res.json();
        if (data.success) {
          mensaje.textContent = 'Se ha enviado un enlace a tu correo si existe en el sistema.';
        } else {
          mensaje.textContent = data.error || 'No se pudo enviar el enlace.';
        }
      } catch (err) {
        mensaje.textContent = 'Error de conexión.';
      }
    };
  </script>
</body>
</html>
