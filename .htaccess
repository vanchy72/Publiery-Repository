# Activar el motor de reescritura de URLs de Apache
RewriteEngine On

# No mostrar el contenido de los directorios si no hay un archivo index
Options -Indexes

# Bloquear el acceso directo al directorio de configuración para mayor seguridad
RewriteRule ^config/ - [F,L]

# --- REGLAS PARA URLS LIMPIAS (sin .php) ---

# Excluir APIs y archivos PHP específicos de las reglas de reescritura
RewriteCond %{REQUEST_URI} !^/publiery/api/ [NC]
RewriteCond %{REQUEST_URI} !\.php$ [NC]

# 1. Redirigir internamente una solicitud como /login a /login.php
# No se aplica si la solicitud es un archivo o directorio que ya existe.
RewriteCond %{REQUEST_FILENAME} !-d
RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME}\.php -f
RewriteRule ^(.*)$ $1.php [L]

# 2. (Opcional) Si un usuario escribe la URL con .php, redirigirlo a la versión limpia
# PERO NO para archivos en /api/
RewriteCond %{REQUEST_URI} !^/publiery/api/ [NC]
RewriteCond %{THE_REQUEST} \s/+(.+?)\.php[\s?] [NC]
RewriteRule ^ /%1 [R=301,L]
